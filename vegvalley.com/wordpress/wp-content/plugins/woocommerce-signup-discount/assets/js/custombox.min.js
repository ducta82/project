/*
 *  Custombox v2.1.0 - 2014-11-22
 *  Modal Window Effects with transitions CSS3.
 *  http://dixso.github.io/custombox/
 *  (c) 2014 Julio de la Calle - @dixso9
 *
 *  Under MIT License - http://opensource.org/licenses/MIT
 */
var Custombox=function(a,b,c){"use strict";var d={create:document.createElement,settings:[],overlay:[],wrapper:[],container:[],modal:[],content:[],inline:[],size:[],close:[],open:[],scroll:[],item:-1},e={target:null,cache:!1,escKey:!0,zIndex:"auto",overlay:!0,overlayColor:"#000",overlayOpacity:.8,overlayClose:!0,overlaySpeed:300,overlayEffect:"auto",width:null,effect:"fadein",position:"center, center",animation:null,speed:500,open:null,complete:null,close:null},f={oldBrowser:navigator.appVersion.indexOf("MSIE 8.")>-1||navigator.appVersion.indexOf("MSIE 9.")>-1||/(iPhone|iPad|iPod)\sOS\s6/.test(navigator.userAgent),overlay:{perspective:["letmein","makeway","slip"],together:["corner","slidetogether","scale","door","push","contentscale","simplegenie","slit","slip"]},modal:{position:["slide","flip","rotate"]}},g={init:function(){this.merge().built().check().binds()},merge:function(){return d.item++,d.settings.push(h.extend({},e,d.options)),delete d.options,"auto"===d.settings[d.item].overlayEffect&&(d.settings[d.item].overlayEffect=d.settings[d.item].effect),this},built:function(){var e=h.zIndex();if(2147483647===e&&(e=a.getComputedStyle(d.modal[d.item]).getPropertyValue("z-index")),c.classList.add("custombox-open","custombox-open-"+d.settings[d.item].overlayEffect),f.overlay.perspective.indexOf(d.settings[d.item].overlayEffect)>-1&&(d.scroll.push(c&&c.scrollTop||b.body&&b.body.scrollTop||0),c.classList.add("custombox-perspective"),a.scrollTo(0,0)),!d.item){for(d.main=d.create.call(b,"div");b.body.firstChild;)d.main.appendChild(b.body.firstChild);b.body.appendChild(d.main)}return"push"===d.settings[d.item].overlayEffect&&(d.main.style.transitionDuration=d.settings[d.item].speed+"ms"),d.main.classList.add("custombox-container","custombox-container-"+d.settings[d.item].overlayEffect),d.settings[d.item].overlay?(d.overlay.push(d.create.call(b,"div")),d.overlay[d.item].classList.add("custombox-overlay","custombox-overlay-"+d.settings[d.item].overlayEffect),d.overlay[d.item].style.zIndex=e+2,d.overlay[d.item].style.backgroundColor=d.settings[d.item].overlayColor,f.overlay.perspective.indexOf(d.settings[d.item].overlayEffect)>-1||f.overlay.together.indexOf(d.settings[d.item].overlayEffect)>-1?d.overlay[d.item].style.opacity=d.settings[d.item].overlayOpacity:d.overlay[d.item].classList.add("custombox-overlay-default"),d.overlay[d.item].style.transitionDuration=f.overlay.together.indexOf(d.settings[d.item].overlayEffect)>-1?d.settings[d.item].speed+"ms":d.settings[d.item].overlaySpeed+"ms",b.body.insertBefore(d.overlay[d.item],b.body.lastChild.nextSibling)):d.overlay.push(null),d.wrapper.push(d.create.call(b,"div")),d.wrapper[d.item].classList.add("custombox-modal-wrapper","custombox-modal-wrapper-"+d.settings[d.item].effect),d.wrapper[d.item].style.zIndex=e+3,b.body.insertBefore(d.wrapper[d.item],b.body.lastChild.nextSibling),d.container.push(d.create.call(b,"div")),d.container[d.item].classList.add("custombox-modal-container","custombox-modal-container-"+d.settings[d.item].effect),d.container[d.item].style.zIndex=e+4,f.modal.position.indexOf(d.settings[d.item].effect)>-1&&(d.settings[d.item].animation=null!==d.settings[d.item].animation?d.settings[d.item].animation.indexOf(",")>-1?d.settings[d.item].animation.split(","):[d.settings[d.item].animation]:"slide"===d.settings[d.item].effect?["top"]:"flip"===d.settings[d.item].effect?["horizontal"]:["bottom"]),d.modal.push(d.create.call(b,"div")),d.modal[d.item].classList.add("custombox-modal","custombox-modal-"+d.settings[d.item].effect+(f.modal.position.indexOf(d.settings[d.item].effect)>-1?"-"+d.settings[d.item].animation[0].trim():"")),d.modal[d.item].style.transitionDuration=d.settings[d.item].speed+"ms",d.modal[d.item].style.zIndex=e+4,d.wrapper[d.item].appendChild(d.container[d.item]).appendChild(d.modal[d.item]),this},check:function(){"function"==typeof d.settings[d.item].open&&d.settings[d.item].open.call();var a=b.createEvent("Event");return a.initEvent("custombox.open",!0,!0),b.dispatchEvent(a),d.settings[d.item].position.indexOf(",")>-1?(d.settings[d.item].position=d.settings[d.item].position.split(","),"#"===d.settings[d.item].target.charAt(0)||"."===d.settings[d.item].target.charAt(0)&&"/"!==d.settings[d.item].target.charAt(1)?b.querySelector(d.settings[d.item].target)?(d.inline.push(d.create.call(b,"div")),d.content.push(b.querySelector(d.settings[d.item].target)),d.content[d.item].style.display="block",d.content[d.item].parentNode.insertBefore(d.inline[d.item],d.content[d.item]),this.size().open()):this.error():this.ajax()):this.error(),this},ajax:function(){var a=this,c=new XMLHttpRequest,e=d.create.call(b,"div");c.onreadystatechange=function(){4===c.readyState&&(200===c.status?(e.innerHTML=c.responseText,d.content.push(e),d.content[d.item].style.display="block",!/(iPhone|iPad|iPod)\sOS\s6/.test(navigator.userAgent)&&f.oldBrowser?d.content[d.item].style.styleFloat="left":d.content[d.item].style.cssFloat="left",d.container[d.item].appendChild(d.content[d.item]),a.size().open()):a.error())},c.open("GET",d.settings[d.item].target+(d.settings[d.item].cache?"":"?_="+Date.now()),!0),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.send(null)},size:function(){var b=d.content[d.item].offsetWidth;if(d.inline[d.item]||(!/(iPhone|iPad|iPod)\sOS\s6/.test(navigator.userAgent)&&f.oldBrowser?d.content[d.item].style.styleFloat="none":d.content[d.item].style.cssFloat="none"),isNaN(d.settings[d.item].width)||null===d.settings[d.item].width||(b=parseInt(d.settings[d.item].width,0)),d.size.push(b),d.size[d.item]+60>=a.innerWidth){d.container[d.item].style.width="auto",d.container[d.item].style.margin="5%",d.wrapper[d.item].style.width=a.innerWidth+"px";for(var c=0,e=d.content[d.item].querySelectorAll(":scope > *"),g=e.length;g>c;c++)e[c].offsetWidth>a.innerWidth&&(e[c].style.width="auto")}else{switch(d.settings[d.item].position[0].trim()){case"left":d.container[d.item].style.marginLeft=0;break;case"right":d.container[d.item].style.marginRight=0}d.container[d.item].style.width=d.size[d.item]+"px"}if(d.content[d.item].style.width="auto",d.modal[d.item].appendChild(d.content[d.item]),d.content[d.item].offsetHeight>=a.innerHeight)d.container[d.item].style.marginTop="5%",d.container[d.item].style.marginBottom="5%";else{var h;switch(d.settings[d.item].position[1].trim()){case"top":h=0;break;case"bottom":h=a.innerHeight-d.content[d.item].offsetHeight+"px";break;default:h=a.innerHeight/2-d.content[d.item].offsetHeight/2+"px"}d.container[d.item].style.marginTop=h}return this},open:function(){if(d.settings[d.item].overlay)if(f.overlay.perspective.indexOf(d.settings[d.item].overlayEffect)>-1||f.overlay.together.indexOf(d.settings[d.item].overlayEffect)>-1?d.overlay[d.item].classList.add("custombox-overlay-open"):d.overlay[d.item].style.opacity=d.settings[d.item].overlayOpacity,d.main.classList.add("custombox-container-open"),f.overlay.together.indexOf(d.settings[d.item].overlayEffect)>-1)d.wrapper[d.item].classList.add("custombox-modal-open");else{var a=function(){d.overlay[d.item].removeEventListener("transitionend",a),d.wrapper[d.item].classList.add("custombox-modal-open")};d.overlay[d.item].addEventListener("transitionend",a,!1)}else d.wrapper[d.item].classList.add("custombox-modal-open"),d.main.classList.add("custombox-container-open");return this},binds:function(){var c=this;d.settings[d.item].escKey&&(b.onkeydown=function(b){b=b||a.event,27===b.keyCode&&c.close()}),d.settings[d.item].overlayClose&&d.wrapper[d.item].addEventListener("click",function(a){a.target===d.wrapper[d.item]&&c.close()},!1),a.addEventListener("onorientationchange"in a?"orientationchange":"resize",function(){c.responsive()},!1);var e=function(){if(!d.inline[d.item])for(var a=0,c=d.modal[d.item].getElementsByTagName("script"),e=c.length;e>a;a++)new Function(c[a].text)();d.settings[d.item]&&"function"==typeof d.settings[d.item].complete&&d.settings[d.item].complete.call();var f=b.createEvent("Event");f.initEvent("custombox.complete",!0,!0),b.dispatchEvent(f)},g=function(){e(),d.modal[d.item].removeEventListener("transitionend",g)};f.oldBrowser?e():"slit"!==d.settings[d.item].effect?d.modal[d.item].addEventListener("transitionend",g,!1):d.modal[d.item].addEventListener("animationend",g,!1)},close:function(){var e=function(){if(c.classList.remove("custombox-open-"+d.settings[d.item].overlayEffect),d.settings[d.item].overlay&&(d.overlay[d.item].classList.add("custombox-overlay-close"),d.overlay[d.item].style.opacity&&(d.overlay[d.item].style.opacity=0),d.overlay[d.item].classList.remove("custombox-overlay-open"),d.main.classList.remove("custombox-container-open")),f.oldBrowser||!d.overlay[d.item])g();else{var a=function(){d.overlay[d.item].removeEventListener("transitionend",a),g()};d.overlay[d.item].addEventListener("transitionend",a,!1)}},g=function(){d.item||(c.classList.remove("custombox-perspective","custombox-open"),"undefined"!=typeof d.scroll[d.item]&&a.scrollTo(0,d.scroll[d.item])),c.classList.remove("custombox-open-"+d.settings[d.item].overlayEffect),d.inline[d.item]&&(!/(iPhone|iPad|iPod)\sOS\s6/.test(navigator.userAgent)&&f.oldBrowser?(d.content[d.item].removeAttribute("width"),d.content[d.item].removeAttribute("display")):(d.content[d.item].style.removeProperty("width"),d.content[d.item].style.removeProperty("display")),d.inline[d.item].parentNode.replaceChild(d.content[d.item],d.inline[d.item])),d.main.classList.remove("custombox-container-"+d.settings[d.item].overlayEffect),d.wrapper[d.item].parentNode.removeChild(d.wrapper[d.item]),d.settings[d.item].overlay&&d.overlay[d.item].parentNode.removeChild(d.overlay[d.item]),"function"==typeof d.settings[d.item].close&&d.settings[d.item].close.call();var e=b.createEvent("Event");if(e.initEvent("custombox.close",!0,!0),b.dispatchEvent(e),!d.item){for(var g=b.querySelectorAll(".custombox-container > *"),h=0,i=g.length;i>h;h++)document.body.insertBefore(g[h],d.main);d.main.parentNode&&d.main.parentNode.removeChild(d.main)}d.wrapper.pop(),d.inline[d.item]&&d.inline.pop(),d.content.pop(),d.container.pop(),d.modal.pop(),d.overlay.pop(),d.size.pop(),d.settings.pop(),d.scroll.pop(),d.item--};if(f.modal.position.indexOf(d.settings[d.item].effect)>-1&&d.settings[d.item].animation.length>1&&(d.modal[d.item].classList.remove("custombox-modal-"+d.settings[d.item].effect+"-"+d.settings[d.item].animation[0]),d.modal[d.item].classList.add("custombox-modal-"+d.settings[d.item].effect+"-"+d.settings[d.item].animation[1].trim())),d.wrapper[d.item].classList.remove("custombox-modal-open"),f.oldBrowser||f.overlay.together.indexOf(d.settings[d.item].overlayEffect)>-1)e();else{var h=function(){d.wrapper[d.item].removeEventListener("transitionend",h),e()};d.wrapper[d.item].addEventListener("transitionend",h,!1)}},responsive:function(){for(var b,c=0,e=d.container.length;e>c;c++){if(d.size[c]+60>=a.innerWidth)d.container[c].style.width="auto",d.container[c].style.marginLeft="5%",d.container[c].style.marginRight="5%",d.wrapper[d.item].style.width=a.innerWidth+"px";else{switch(d.settings[d.item].position[0].trim()){case"left":d.container[c].style.marginLeft=0;break;case"right":d.container[c].style.marginRight=0;break;default:d.container[c].style.marginLeft="auto",d.container[c].style.marginRight="auto"}d.container[c].style.width=d.size[c]+"px",d.wrapper[d.item].style.width="auto"}if(d.content[c].offsetHeight>=a.innerHeight)d.container[c].style.marginTop="5%",d.container[c].style.marginBottom="5%";else{switch(d.settings[d.item].position[1]){case"top":b=0;break;case"bottom":b=a.innerHeight-d.content[c].offsetHeight+"px";break;default:b=a.innerHeight/2-d.content[c].offsetHeight/2+"px"}d.container[c].style.marginTop=b}}},error:function(){alert("Error to load this target: "+d.settings[d.item].target)}},h={zIndex:function(){a.getComputedStyle||(a.getComputedStyle=function(a){return this.el=a,this.getPropertyValue=function(b){var c=/(\-([a-z]){1})/g;return"float"==b&&(b="styleFloat"),c.test(b)&&(b=b.replace(c,function(){return arguments[2].toUpperCase()})),a.currentStyle[b]?a.currentStyle[b]:null},this});var b=0;if(isNaN(d.settings[d.item].zIndex))for(var c=0,e=document.getElementsByTagName("*"),f=e.length;f>c;c+=1){var g=a.getComputedStyle(e[c]).getPropertyValue("z-index");g&&(g=+g,g>b&&(b=g))}else b=d.settings[d.item].zIndex;return b},extend:function(){for(var a=1,b=arguments.length;b>a;a++)for(var c in arguments[a])arguments[a].hasOwnProperty(c)&&(arguments[0][c]=arguments[a][c]);return arguments[0]}};return{open:function(a){d.options=a,g.init()},close:function(){g.close()}}}(window,document,document.documentElement);